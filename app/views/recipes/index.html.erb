<% content_for :title, "All Recipes - Alchefeast" %>

<div class="container-fluid">

  <div class="container">
    <!-- Page Header -->
    <div class="row mb-4">
      <div class="col-12">
        <h1 class="display-5 fw-bold text-primary">
          <i class="bi bi-book me-2"></i>All Recipes
        </h1>
        <p class="lead text-muted">Discover amazing recipes from around the world</p>
      </div>
    </div>

    <!-- Filters -->
    <%= turbo_frame_tag "filters" do %>
      <div class="row mb-4">
        <div class="col-12">
          <div class="card border-0 shadow-sm">
            <div class="card-body">
              <h5 class="card-title mb-3">
                <i class="bi bi-funnel me-2"></i>Filter Recipes
              </h5>
              
              <div class="row">
                <!-- Popular Categories Filter -->
                <div class="col-md-4 mb-3">
                  <label class="form-label fw-semibold">Popular Categories</label>
                  <div class="d-flex flex-wrap gap-2" data-controller="turbo">
                    <%= link_to "All", recipes_path, 
                        class: "btn #{'btn-primary' if params[:category].blank?} #{'btn-outline-primary' unless params[:category].blank?} btn-sm",
                        data: { action: "click->turbo#getTurboStream" } %>
                    <% @popular_categories.each do |category| %>
                      <%= link_to category, recipes_path(category: category), 
                          class: "btn #{'btn-primary' if params[:category] == category} #{'btn-outline-primary' unless params[:category] == category} btn-sm",
                          data: { action: "click->turbo#getTurboStream" } %>
                    <% end %>
                  </div>
                </div>
                
                <!-- Recipe Name Search -->
                <div class="col-md-4 mb-3">
                  <label class="form-label fw-semibold">Find by Recipe Name</label>
                  <%= form_with url: recipes_path, method: :get, local: true, class: "d-flex", 
                      data: { controller: "turbo", action: "submit->turbo#submitForm" } do |form| %>
                    <%= form.text_field :q, 
                        value: params[:q], 
                        placeholder: "e.g., pasta, curry", 
                        class: "form-control form-control-sm me-2" %>
                    <%= form.submit class: "btn btn-primary btn-sm" do %>
                      <i class="bi bi-search"></i>
                    <% end %>
                  <% end %>
                </div>
                
                <!-- Ingredient Search -->
                <div class="col-md-4 mb-3">
                  <label class="form-label fw-semibold">Find by Ingredients</label>
                  <%= form_with url: recipes_path, method: :get, local: true, class: "d-flex", 
                      data: { controller: "turbo", action: "submit->turbo#submitForm" } do |form| %>
                    <%= form.text_field :ingredients, 
                        value: params[:ingredients], 
                        placeholder: "e.g., chicken, rice", 
                        class: "form-control form-control-sm me-2" %>
                    <%= form.submit class: "btn btn-warning btn-sm" do %>
                      <i class="bi bi-search"></i>
                    <% end %>
                  <% end %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% end %>

    <!-- Recipes Grid -->
    <%= render 'recipes_grid', recipes: @recipes %>
  </div>
</div>

<!-- Recipe Modal Frame -->
<%= turbo_frame_tag "recipe_modal" do %>
  <!-- Modal content will be loaded here -->
<% end %>

<style>
.recipe-card {
  transition: transform 0.2s ease-in-out;
}

.recipe-card:hover {
  transform: translateY(-5px);
}
</style>
